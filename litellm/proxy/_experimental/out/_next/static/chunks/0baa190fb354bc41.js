(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,371455,172372,e=>{"use strict";var s=e.i(843476),t=e.i(827252),l=e.i(213205),a=e.i(912598),r=e.i(677667),i=e.i(130643),n=e.i(898667),d=e.i(994388),o=e.i(35983),c=e.i(779241),m=e.i(560445),u=e.i(464571),x=e.i(808613),h=e.i(311451),p=e.i(212931),f=e.i(199133),g=e.i(770914),j=e.i(592968),b=e.i(898586),y=e.i(271645),v=e.i(599724),w=e.i(291542),N=e.i(515831),_=e.i(519756),C=e.i(737434),S=e.i(285027),k=e.i(993914),I=e.i(955135);e.i(247167);var U=e.i(931067);let T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM472 744a40 40 0 1080 0 40 40 0 10-80 0zm16-104h48c4.4 0 8-3.6 8-8V448c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v184c0 4.4 3.6 8 8 8z"}}]},name:"file-exclamation",theme:"outlined"};var F=e.i(9583),B=y.forwardRef(function(e,s){return y.createElement(F.default,(0,U.default)({},e,{ref:s,icon:T}))}),V=e.i(764205),L=e.i(59935),O=e.i(220508),P=e.i(964306);let E=y.forwardRef(function(e,s){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:s},e),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}))});var R=e.i(237016),M=e.i(727749);let A=({accessToken:e,teams:t,possibleUIRoles:l,onUsersCreated:a})=>{let[r,i]=(0,y.useState)(!1),[n,o]=(0,y.useState)([]),[c,m]=(0,y.useState)(!1),[u,x]=(0,y.useState)(null),[h,f]=(0,y.useState)(null),[g,j]=(0,y.useState)(null),[U,T]=(0,y.useState)(null),[F,A]=(0,y.useState)(null),[D,$]=(0,y.useState)("http://localhost:4000");(0,y.useEffect)(()=>{(async()=>{try{let s=await (0,V.getProxyUISettings)(e);A(s)}catch(e){console.error("Error fetching UI settings:",e)}})(),$(new URL("/",window.location.href).toString())},[e]);let z=async()=>{m(!0);let s=n.map(e=>({...e,status:"pending"}));o(s);let t=!1;for(let l=0;l<s.length;l++){let a=s[l];try{let s={user_email:a.user_email,user_role:a.user_role};if(a.teams&&"string"==typeof a.teams&&""!==a.teams.trim()&&(s.teams=a.teams.split(",").map(e=>e.trim()).filter(Boolean),0===s.teams.length&&delete s.teams),a.models&&"string"==typeof a.models&&""!==a.models.trim()&&(s.models=a.models.split(",").map(e=>e.trim()).filter(Boolean),0===s.models.length&&delete s.models),a.max_budget&&""!==a.max_budget.toString().trim()){let e=parseFloat(a.max_budget.toString());!isNaN(e)&&e>0&&(s.max_budget=e)}a.budget_duration&&""!==a.budget_duration.trim()&&(s.budget_duration=a.budget_duration.trim()),a.metadata&&"string"==typeof a.metadata&&""!==a.metadata.trim()&&(s.metadata=a.metadata.trim()),console.log("Sending user data:",s);let r=await (0,V.userCreateCall)(e,null,s);if(console.log("Full response:",r),r&&(r.key||r.user_id)){t=!0,console.log("Success case triggered");let s=r.data?.user_id||r.user_id;try{if(F?.SSO_ENABLED){let e=new URL("/ui",D).toString();o(s=>s.map((s,t)=>t===l?{...s,status:"success",key:r.key||r.user_id,invitation_link:e}:s))}else{let t=await (0,V.invitationCreateCall)(e,s),a=new URL(`/ui?invitation_id=${t.id}`,D).toString();o(e=>e.map((e,s)=>s===l?{...e,status:"success",key:r.key||r.user_id,invitation_link:a}:e))}}catch(e){console.error("Error creating invitation:",e),o(e=>e.map((e,s)=>s===l?{...e,status:"success",key:r.key||r.user_id,error:"User created but failed to generate invitation link"}:e))}}else{console.log("Error case triggered");let e=r?.error||"Failed to create user";console.log("Error message:",e),o(s=>s.map((s,t)=>t===l?{...s,status:"failed",error:e}:s))}}catch(s){console.error("Caught error:",s);let e=s?.response?.data?.error||s?.message||String(s);o(s=>s.map((s,t)=>t===l?{...s,status:"failed",error:e}:s))}}m(!1),t&&a&&a()},q=[{title:"Row",dataIndex:"rowNumber",key:"rowNumber",width:80},{title:"Email",dataIndex:"user_email",key:"user_email"},{title:"Role",dataIndex:"user_role",key:"user_role"},{title:"Teams",dataIndex:"teams",key:"teams"},{title:"Budget",dataIndex:"max_budget",key:"max_budget"},{title:"Status",key:"status",render:(e,t)=>t.isValid?t.status&&"pending"!==t.status?"success"===t.status?(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(O.CheckCircleIcon,{className:"h-5 w-5 text-green-500 mr-2"}),(0,s.jsx)("span",{className:"text-green-500",children:"Success"})]}),t.invitation_link&&(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:t.invitation_link}),(0,s.jsx)(R.CopyToClipboard,{text:t.invitation_link,onCopy:()=>M.default.success("Invitation link copied!"),children:(0,s.jsx)("button",{className:"ml-1 text-blue-500 text-xs hover:text-blue-700",children:"Copy"})})]})})]}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(P.XCircleIcon,{className:"h-5 w-5 text-red-500 mr-2"}),(0,s.jsx)("span",{className:"text-red-500",children:"Failed"})]}),t.error&&(0,s.jsx)("span",{className:"text-sm text-red-500 ml-7",children:JSON.stringify(t.error)})]}):(0,s.jsx)("span",{className:"text-gray-500",children:"Pending"}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(P.XCircleIcon,{className:"h-5 w-5 text-red-500 mr-2"}),(0,s.jsx)("span",{className:"text-red-500",children:"Invalid"})]}),t.error&&(0,s.jsx)("span",{className:"text-sm text-red-500 ml-7",children:t.error})]})}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Button,{className:"mb-0",onClick:()=>i(!0),children:"+ Bulk Invite Users"}),(0,s.jsx)(p.Modal,{title:"Bulk Invite Users",open:r,width:800,onCancel:()=>i(!1),bodyStyle:{maxHeight:"70vh",overflow:"auto"},footer:null,children:(0,s.jsx)("div",{className:"flex flex-col",children:0===n.length?(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"1"}),(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Download and fill the template"})]}),(0,s.jsxs)("div",{className:"ml-11 mb-6",children:[(0,s.jsx)("p",{className:"mb-4",children:"Add multiple users at once by following these steps:"}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2 mb-4",children:[(0,s.jsx)("li",{children:"Download our CSV template"}),(0,s.jsx)("li",{children:"Add your users' information to the spreadsheet"}),(0,s.jsx)("li",{children:"Save the file and upload it here"}),(0,s.jsx)("li",{children:"After creation, download the results file containing the Virtual Keys for each user"})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[(0,s.jsx)("h4",{className:"font-medium mb-2",children:"Template Column Names"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"user_email"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"User's email address (required)"})]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"user_role"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:'User\'s role (one of: "proxy_admin", "proxy_admin_viewer", "internal_user", "internal_user_viewer")'})]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"teams"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated team IDs (e.g., "team-1,team-2")'})]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"max_budget"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:'Maximum budget as a number (e.g., "100")'})]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"budget_duration"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:'Budget reset period (e.g., "30d", "1mo")'})]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"models"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated allowed models (e.g., "gpt-3.5-turbo,gpt-4")'})]})]})]})]}),(0,s.jsxs)(d.Button,{onClick:()=>{let e=new Blob([L.default.unparse([["user_email","user_role","teams","max_budget","budget_duration","models"],["user@example.com","internal_user","team-id-1,team-id-2","100","30d","gpt-3.5-turbo,gpt-4"]])],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="bulk_users_template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s)},size:"lg",className:"w-full md:w-auto",children:[(0,s.jsx)(C.DownloadOutlined,{className:"mr-2"})," Download CSV Template"]})]}),(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"2"}),(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Upload your completed CSV"})]}),(0,s.jsxs)("div",{className:"ml-11",children:[U?(0,s.jsxs)("div",{className:`mb-4 p-4 rounded-md border ${g?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[g?(0,s.jsx)(B,{className:"text-red-500 text-xl mr-3"}):(0,s.jsx)(k.FileTextOutlined,{className:"text-blue-500 text-xl mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.Typography.Text,{strong:!0,className:g?"text-red-800":"text-blue-800",children:U.name}),(0,s.jsxs)(b.Typography.Text,{className:`block text-xs ${g?"text-red-600":"text-blue-600"}`,children:[(U.size/1024).toFixed(1)," KB â€¢ ",new Date().toLocaleDateString()]})]})]}),(0,s.jsxs)(d.Button,{size:"xs",variant:"secondary",onClick:()=>{T(null),o([]),x(null),f(null),j(null)},className:"flex items-center",children:[(0,s.jsx)(I.DeleteOutlined,{className:"mr-1"})," Remove"]})]}),g?(0,s.jsxs)("div",{className:"mt-3 text-red-600 text-sm flex items-start",children:[(0,s.jsx)(S.WarningOutlined,{className:"mr-2 mt-0.5"}),(0,s.jsx)("span",{children:g})]}):!h&&(0,s.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,s.jsx)("div",{className:"bg-blue-500 h-1.5 rounded-full w-full animate-pulse"})}),(0,s.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"Processing..."})]})]}):(0,s.jsx)(N.Upload,{beforeUpload:e=>((x(null),f(null),j(null),T(e),"text/csv"===e.type||e.name.endsWith(".csv"))?e.size>5242880?j(`File is too large (${(e.size/1048576).toFixed(1)} MB). Please upload a CSV file smaller than 5MB.`):L.default.parse(e,{complete:e=>{if(!e.data||0===e.data.length){f("The CSV file appears to be empty. Please upload a file with data."),o([]);return}if(1===e.data.length){f("The CSV file only contains headers but no user data. Please add user data to your CSV."),o([]);return}let s=e.data[0];if(0===s.length||1===s.length&&""===s[0]){f("The CSV file doesn't contain any column headers. Please make sure your CSV has headers."),o([]);return}let l=["user_email","user_role"].filter(e=>!s.includes(e));if(l.length>0){f(`Your CSV is missing these required columns: ${l.join(", ")}. Please add these columns to your CSV file.`),o([]);return}try{let l=e.data.slice(1).map((e,l)=>{if(0===e.length||1===e.length&&""===e[0])return null;if(e.length<s.length)return{rowNumber:l+2,isValid:!1,error:`Row ${l+2} has fewer columns than the header row. Please ensure all data is properly formatted.`,user_email:"",user_role:""};let a={user_email:e[s.indexOf("user_email")]?.trim()||"",user_role:e[s.indexOf("user_role")]?.trim()||"",teams:e[s.indexOf("teams")]?.trim(),max_budget:e[s.indexOf("max_budget")]?.trim(),budget_duration:e[s.indexOf("budget_duration")]?.trim(),models:e[s.indexOf("models")]?.trim(),rowNumber:l+2,isValid:!0,error:""},r=[];if(a.user_email?a.user_email.includes("@")&&a.user_email.includes(".")||r.push("Invalid email format (must contain @ and domain)"):r.push("Email is required"),a.user_role){let e=["proxy_admin","proxy_admin_viewer","internal_user","internal_user_viewer"];e.includes(a.user_role)||r.push(`Invalid role "${a.user_role}". Must be one of: ${e.join(", ")}`)}else r.push("Role is required");if(a.max_budget&&""!==a.max_budget.toString().trim()&&(isNaN(parseFloat(a.max_budget.toString()))?r.push(`Max budget "${a.max_budget}" must be a number`):0>=parseFloat(a.max_budget.toString())&&r.push("Max budget must be greater than 0")),a.budget_duration&&!a.budget_duration.match(/^\d+[dhmwy]$|^\d+mo$/)&&r.push(`Invalid budget duration format "${a.budget_duration}". Use format like "30d", "1mo", "2w", "6h"`),a.teams&&"string"==typeof a.teams&&t&&t.length>0){let e=t.map(e=>e.team_id),s=a.teams.split(",").map(e=>e.trim()).filter(s=>!e.includes(s));s.length>0&&r.push(`Unknown team(s): ${s.join(", ")}`)}return r.length>0&&(a.isValid=!1,a.error=r.join(", ")),a}).filter(Boolean),a=l.filter(e=>e.isValid);o(l),0===l.length?f("No valid data rows found in the CSV file. Please check your file format."):0===a.length?x("No valid users found in the CSV. Please check the errors below and fix your CSV file."):a.length<l.length?x(`Found ${l.length-a.length} row(s) with errors out of ${l.length} total rows. Please correct them before proceeding.`):M.default.success(`Successfully parsed ${a.length} users`)}catch(s){let e=s instanceof Error?s.message:"Unknown error";x(`Error parsing CSV: ${e}`),o([])}},error:e=>{x(`Failed to parse CSV file: ${e.message}`),o([])},header:!1}):(j(`Invalid file type: ${e.name}. Please upload a CSV file (.csv extension).`),M.default.fromBackend("Invalid file type. Please upload a CSV file.")),!1),accept:".csv",maxCount:1,showUploadList:!1,children:(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[(0,s.jsx)(_.UploadOutlined,{className:"text-3xl text-gray-400 mb-2"}),(0,s.jsx)("p",{className:"mb-1",children:"Drag and drop your CSV file here"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"or"}),(0,s.jsx)(d.Button,{size:"sm",children:"Browse files"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Only CSV files (.csv) are supported"})]})}),h&&(0,s.jsx)("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(E,{className:"h-5 w-5 text-yellow-500 mr-2 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.Typography.Text,{strong:!0,className:"text-yellow-800",children:"CSV Structure Error"}),(0,s.jsx)(b.Typography.Paragraph,{className:"text-yellow-700 mt-1 mb-0",children:h}),(0,s.jsx)(b.Typography.Paragraph,{className:"text-yellow-700 mt-2 mb-0",children:"Please download our template and ensure your CSV follows the required format."})]})]})})]})]}):(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"3"}),(0,s.jsx)("h3",{className:"text-lg font-medium",children:n.some(e=>"success"===e.status||"failed"===e.status)?"User Creation Results":"Review and create users"})]}),u&&(0,s.jsx)("div",{className:"ml-11 mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(S.WarningOutlined,{className:"text-red-500 mr-2 mt-1"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.Text,{className:"text-red-600 font-medium",children:u}),n.some(e=>!e.isValid)&&(0,s.jsxs)("ul",{className:"mt-2 list-disc list-inside text-red-600 text-sm",children:[(0,s.jsx)("li",{children:"Check the table below for specific errors in each row"}),(0,s.jsx)("li",{children:"Common issues include invalid email formats, missing required fields, or incorrect role values"}),(0,s.jsx)("li",{children:"Fix these issues in your CSV file and upload again"})]})]})]})}),(0,s.jsxs)("div",{className:"ml-11",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("div",{className:"flex items-center",children:n.some(e=>"success"===e.status||"failed"===e.status)?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v.Text,{className:"text-lg font-medium mr-3",children:"Creation Summary"}),(0,s.jsxs)(v.Text,{className:"text-sm bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:[n.filter(e=>"success"===e.status).length," Successful"]}),n.some(e=>"failed"===e.status)&&(0,s.jsxs)(v.Text,{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:[n.filter(e=>"failed"===e.status).length," Failed"]})]}):(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v.Text,{className:"text-lg font-medium mr-3",children:"User Preview"}),(0,s.jsxs)(v.Text,{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[n.filter(e=>e.isValid).length," of ",n.length," users valid"]})]})}),!n.some(e=>"success"===e.status||"failed"===e.status)&&(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)(d.Button,{onClick:()=>{o([]),x(null)},variant:"secondary",children:"Back"}),(0,s.jsx)(d.Button,{onClick:z,disabled:0===n.filter(e=>e.isValid).length||c,children:c?"Creating...":`Create ${n.filter(e=>e.isValid).length} Users`})]})]}),n.some(e=>"success"===e.status)&&(0,s.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"mr-3 mt-1",children:(0,s.jsx)(O.CheckCircleIcon,{className:"h-5 w-5 text-blue-500"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.Text,{className:"font-medium text-blue-800",children:"User creation complete"}),(0,s.jsxs)(v.Text,{className:"block text-sm text-blue-700 mt-1",children:[(0,s.jsx)("span",{className:"font-medium",children:"Next step:"})," Download the credentials file containing Virtual Keys and invitation links. Users will need these Virtual Keys to make LLM requests through LiteLLM."]})]})]})}),(0,s.jsx)(w.Table,{dataSource:n,columns:q,size:"small",pagination:{pageSize:5},scroll:{y:300},rowClassName:e=>e.isValid?"":"bg-red-50"}),!n.some(e=>"success"===e.status||"failed"===e.status)&&(0,s.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,s.jsx)(d.Button,{onClick:()=>{o([]),x(null)},variant:"secondary",className:"mr-3",children:"Back"}),(0,s.jsx)(d.Button,{onClick:z,disabled:0===n.filter(e=>e.isValid).length||c,children:c?"Creating...":`Create ${n.filter(e=>e.isValid).length} Users`})]}),n.some(e=>"success"===e.status||"failed"===e.status)&&(0,s.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,s.jsx)(d.Button,{onClick:()=>{o([]),x(null)},variant:"secondary",className:"mr-3",children:"Start New Bulk Import"}),(0,s.jsxs)(d.Button,{onClick:()=>{let e=n.map(e=>({user_email:e.user_email,user_role:e.user_role,status:e.status,key:e.key||"",invitation_link:e.invitation_link||"",error:e.error||""})),s=new Blob([L.default.unparse(e)],{type:"text/csv"}),t=window.URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download="bulk_users_results.csv",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(t)},variant:"primary",className:"flex items-center",children:[(0,s.jsx)(C.DownloadOutlined,{className:"mr-2"})," Download User Credentials"]})]})]})]})})})]})};var D=e.i(663435),$=e.i(355619);function z({isInvitationLinkModalVisible:e,setIsInvitationLinkModalVisible:t,baseUrl:l,invitationLinkData:a,modalType:r="invitation"}){let{Title:i,Paragraph:n}=b.Typography,o=()=>{if(!l)return"";let e=new URL(l).pathname,s=e&&"/"!==e?`${e}/ui`:"ui";if(a?.has_user_setup_sso)return new URL(s,l).toString();let t=`${s}?invitation_id=${a?.id}`;return"resetPassword"===r&&(t+="&action=reset_password"),new URL(t,l).toString()};return(0,s.jsxs)(p.Modal,{title:"invitation"===r?"Invitation Link":"Reset Password Link",open:e,width:800,footer:null,onOk:()=>{t(!1)},onCancel:()=>{t(!1)},children:[(0,s.jsx)(n,{children:"invitation"===r?"Copy and send the generated link to onboard this user to the proxy.":"Copy and send the generated link to the user to reset their password."}),(0,s.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,s.jsx)(v.Text,{className:"text-base",children:"User ID"}),(0,s.jsx)(v.Text,{children:a?.user_id})]}),(0,s.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,s.jsx)(v.Text,{children:"invitation"===r?"Invitation Link":"Reset Password Link"}),(0,s.jsx)(v.Text,{children:(0,s.jsx)(v.Text,{children:o()})})]}),(0,s.jsx)("div",{className:"flex justify-end mt-5",children:(0,s.jsx)(R.CopyToClipboard,{text:o(),onCopy:()=>M.default.success("Copied!"),children:(0,s.jsx)(d.Button,{variant:"primary",children:"invitation"===r?"Copy invitation link":"Copy password reset link"})})})]})}e.s(["default",()=>z],172372);let{Option:q}=f.Select,{Text:K,Link:H,Title:G}=b.Typography;e.s(["CreateUserButton",0,({userID:e,accessToken:b,teams:v,possibleUIRoles:w,onUserCreated:N,isEmbedded:_=!1})=>{let C=(0,a.useQueryClient)(),[S,k]=(0,y.useState)(null),[I]=x.Form.useForm(),[U,T]=(0,y.useState)(!1),[F,B]=(0,y.useState)(!1),[L,O]=(0,y.useState)([]),[P,E]=(0,y.useState)(!1),[R,q]=(0,y.useState)(null),[G,W]=(0,y.useState)(null),[J,Q]=(0,y.useState)(!1),[X]=x.Form.useForm();(0,y.useEffect)(()=>{let s=async()=>{try{let s=await (0,V.modelAvailableCall)(b,e,"any"),t=[];for(let e=0;e<s.data.length;e++){let l=s.data[e];t.push(l.id)}O(t);let l=await (0,V.getProxyUISettings)(b);k(l)}catch(e){console.error("Error fetching model data:",e)}};W((0,V.getProxyBaseUrl)()),s()},[]);let Y=async s=>{try{M.default.info("Making API Call"),_||T(!0),s.models&&0!==s.models.length||"proxy_admin"===s.user_role||(s.models=["no-default-models"]);let t=await (0,V.userCreateCall)(b,null,s);await C.invalidateQueries({queryKey:["userList"]}),B(!0);let l=t.data?.user_id||t.user_id;if(N&&_){N(l),I.resetFields();return}if(S?.SSO_ENABLED){let s={id:"u">typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let s=16*Math.random()|0;return("x"==e?s:3&s|8).toString(16)}),user_id:l,is_accepted:!1,accepted_at:null,expires_at:new Date(Date.now()+6048e5),created_at:new Date,created_by:e,updated_at:new Date,updated_by:e,has_user_setup_sso:!0};q(s),E(!0)}else(0,V.invitationCreateCall)(b,l).then(e=>{e.has_user_setup_sso=!1,q(e),E(!0)});M.default.success("API user Created"),I.resetFields(),localStorage.removeItem("userData"+e)}catch(s){let e=s.response?.data?.detail||s?.message||"Error creating the user";M.default.fromBackend(e),console.error("Error creating the user:",s)}},Z=async s=>{try{M.default.info("Creating user..."),s.models&&0!==s.models.length||"proxy_admin"===s.user_role||(s.models=["no-default-models"]),await (0,V.userCreateCall)(b,null,s),await C.invalidateQueries({queryKey:["userList"]}),M.default.success("User created successfully. They can now log in with their email and password."),X.resetFields(),Q(!1),localStorage.removeItem("userData"+e)}catch(s){let e=s.response?.data?.detail||s?.message||"Error creating the user";M.default.fromBackend(e),console.error("Error creating the user:",s)}};return _?(0,s.jsxs)(x.Form,{form:I,onFinish:Y,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsx)(m.Alert,{message:"Email invitations",description:(0,s.jsxs)(s.Fragment,{children:["New users receive an email invite only when an email integration (SMTP, Resend, or SendGrid) is configured."," ",(0,s.jsx)(H,{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",children:"Learn how to set up email notifications"})]}),type:"info",showIcon:!0,className:"mb-4"}),(0,s.jsx)(x.Form.Item,{label:"User Email",name:"user_email",children:(0,s.jsx)(c.TextInput,{placeholder:""})}),(0,s.jsx)(x.Form.Item,{label:"User Role",name:"user_role",children:(0,s.jsx)(f.Select,{children:w&&Object.entries(w).map(([e,{ui_label:t,description:l}])=>(0,s.jsx)(o.SelectItem,{value:e,title:t,children:(0,s.jsxs)("div",{className:"flex",children:[t," ",(0,s.jsx)(K,{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},e))})}),(0,s.jsx)(x.Form.Item,{label:"Team",name:"team_id",children:(0,s.jsx)(f.Select,{placeholder:"Select Team",style:{width:"100%"},children:(0,s.jsx)(D.default,{teams:v})})}),(0,s.jsx)(x.Form.Item,{label:"Metadata",name:"metadata",children:(0,s.jsx)(h.Input.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(u.Button,{htmlType:"submit",children:"Create User"})})]}):(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.Button,{className:"mb-0",onClick:()=>Q(!0),children:"+ Create User"}),(0,s.jsx)(d.Button,{className:"mb-0",onClick:()=>T(!0),children:"+ Invite User"}),(0,s.jsx)(A,{accessToken:b,teams:v,possibleUIRoles:w}),(0,s.jsxs)(p.Modal,{title:"Invite User",open:U,width:800,footer:null,onOk:()=>{T(!1),I.resetFields()},onCancel:()=>{T(!1),B(!1),I.resetFields()},children:[(0,s.jsxs)(g.Space,{direction:"vertical",size:"middle",children:[(0,s.jsx)(K,{className:"mb-1",children:"Create a User who can own keys"}),(0,s.jsx)(m.Alert,{message:"Email invitations",description:(0,s.jsxs)(s.Fragment,{children:["New users receive an email invite only when an email integration (SMTP, Resend, or SendGrid) is configured."," ",(0,s.jsx)(H,{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",children:"Learn how to set up email notifications"})]}),type:"info",showIcon:!0,className:"mb-4"})]}),(0,s.jsxs)(x.Form,{form:I,onFinish:Y,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsx)(x.Form.Item,{label:"User Email",name:"user_email",children:(0,s.jsx)(h.Input,{})}),(0,s.jsx)(x.Form.Item,{label:(0,s.jsxs)("span",{children:["Global Proxy Role"," ",(0,s.jsx)(j.Tooltip,{title:"This role is independent of any team/org specific roles. Configure Team / Organization Admins in the Settings",children:(0,s.jsx)(t.InfoCircleOutlined,{})})]}),name:"user_role",children:(0,s.jsx)(f.Select,{children:w&&Object.entries(w).map(([e,{ui_label:t,description:l}])=>(0,s.jsxs)(o.SelectItem,{value:e,title:t,children:[(0,s.jsx)(K,{children:t}),(0,s.jsxs)(K,{type:"secondary",children:[" - ",l]})]},e))})}),(0,s.jsx)(x.Form.Item,{label:"Team",className:"gap-2",name:"team_id",help:"If selected, user will be added as a 'user' role to the team.",children:(0,s.jsx)(D.default,{teams:v})}),(0,s.jsx)(x.Form.Item,{label:"Metadata",name:"metadata",children:(0,s.jsx)(h.Input.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,s.jsxs)(r.Accordion,{children:[(0,s.jsx)(n.AccordionHeader,{children:(0,s.jsx)(K,{strong:!0,children:"Personal Key Creation"})}),(0,s.jsx)(i.AccordionBody,{children:(0,s.jsx)(x.Form.Item,{className:"gap-2",label:(0,s.jsxs)("span",{children:["Models"," ",(0,s.jsx)(j.Tooltip,{title:"Models user has access to, outside of team scope.",children:(0,s.jsx)(t.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"models",help:"Models user has access to, outside of team scope.",children:(0,s.jsxs)(f.Select,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,s.jsx)(f.Select.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),(0,s.jsx)(f.Select.Option,{value:"no-default-models",children:"No Default Models"},"no-default-models"),L.map(e=>(0,s.jsx)(f.Select.Option,{value:e,children:(0,$.getModelDisplayName)(e)},e))]})})})]}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(u.Button,{type:"primary",icon:(0,s.jsx)(l.UserAddOutlined,{}),htmlType:"submit",children:"Invite User"})})]})]}),F&&(0,s.jsx)(z,{isInvitationLinkModalVisible:P,setIsInvitationLinkModalVisible:E,baseUrl:G||"",invitationLinkData:R}),(0,s.jsxs)(p.Modal,{title:"Create User",open:J,width:800,footer:null,onCancel:()=>{Q(!1),X.resetFields()},children:[(0,s.jsx)(g.Space,{direction:"vertical",size:"middle",children:(0,s.jsx)(K,{className:"mb-1",children:"Create a user with email and password. They can log in immediately."})}),(0,s.jsxs)(x.Form,{form:X,onFinish:Z,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",className:"mt-4",children:[(0,s.jsx)(x.Form.Item,{label:"User Email",name:"user_email",rules:[{required:!0,message:"Please enter user email"}],children:(0,s.jsx)(h.Input,{placeholder:"user@example.com"})}),(0,s.jsx)(x.Form.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please set a password"}],tooltip:"User will log in with this password",children:(0,s.jsx)(h.Input.Password,{placeholder:"Set user password"})}),(0,s.jsx)(x.Form.Item,{label:(0,s.jsxs)("span",{children:["Global Proxy Role"," ",(0,s.jsx)(j.Tooltip,{title:"This role is independent of any team/org specific roles.",children:(0,s.jsx)(t.InfoCircleOutlined,{})})]}),name:"user_role",children:(0,s.jsx)(f.Select,{children:w&&Object.entries(w).map(([e,{ui_label:t,description:l}])=>(0,s.jsxs)(o.SelectItem,{value:e,title:t,children:[(0,s.jsx)(K,{children:t}),(0,s.jsxs)(K,{type:"secondary",children:[" - ",l]})]},e))})}),(0,s.jsx)(x.Form.Item,{label:"Team",name:"team_id",help:"If selected, user will be added to the team.",children:(0,s.jsx)(D.default,{teams:v})}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(u.Button,{type:"primary",icon:(0,s.jsx)(l.UserAddOutlined,{}),htmlType:"submit",children:"Create User"})})]})]})]})}],371455)}]);